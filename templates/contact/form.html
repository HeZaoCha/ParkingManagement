{% extends "base.html" %}
{% load static %}

{% block title %}联系我们 - 停车场管理系统{% endblock %}

{% block body_class %}min-h-screen{% endblock %}

{% block content %}
<link rel="stylesheet" href="{% static 'contact/form/css/style.css' %}">


<div class="contact-page min-h-screen py-12 px-4 sm:px-6 lg:px-8">
  <div class="max-w-4xl mx-auto">
    {# 回退按钮 #}
    <div class="mb-6">
      <button type="button"
              onclick="history.back()" 
              class="flex items-center gap-2 px-4 py-2 rounded-lg bg-theme-card border border-theme hover:bg-theme-hover transition-colors text-theme-secondary hover:text-theme-primary"
              aria-label="返回上一页">
        <i class="fas fa-arrow-left" aria-hidden="true"></i>
        <span>返回上一页</span>
      </button>
    </div>
    
    {# 页面标题 #}
    <header class="text-center mb-8" role="banner">
      <h1 class="text-4xl font-bold text-theme-primary mb-2">
        <i class="fas fa-headset text-primary-500 mr-2" aria-hidden="true"></i>
        联系我们
      </h1>
      <p class="text-theme-secondary text-lg">您的反馈对我们非常重要，我们会认真对待每一条消息</p>
    </header>

    {# 联系卡片 - 每个卡片使用不同的主题色 #}
    <section class="grid md:grid-cols-2 gap-6 mb-8" aria-label="联系方式" role="region">
      {# 邮件联系 - 蓝色主题 #}
      <article class="contact-card contact-card-email rounded-2xl p-6 shadow-lg" role="article" aria-labelledby="email-contact-title">
        <div class="flex items-center gap-3 mb-4">
          <div class="icon-bg w-12 h-12 rounded-full flex items-center justify-center transition-all" aria-hidden="true">
            <i class="icon fas fa-envelope text-xl"></i>
          </div>
          <div>
            <h3 id="email-contact-title" class="font-semibold">邮件联系</h3>
            <p class="text-sm">发送邮件给管理员</p>
          </div>
        </div>
        <p class="text-sm mb-4">
          您可以通过邮件向我们反馈问题、建议或意见。我们会在24小时内回复。
        </p>
        <button type="button"
                onclick="showEmailForm()" 
                class="btn w-full py-2 px-4 rounded-lg transition-all font-medium"
                aria-label="打开邮件反馈表单">
          <i class="fas fa-paper-plane mr-2" aria-hidden="true"></i>
          填写反馈表单
        </button>
      </article>

      {# GitHub Issues - 紫色主题 #}
      <article class="contact-card contact-card-github rounded-2xl p-6 shadow-lg" role="article" aria-labelledby="github-contact-title">
        <div class="flex items-center gap-3 mb-4">
          <div class="icon-bg w-12 h-12 rounded-full flex items-center justify-center transition-all" aria-hidden="true">
            <i class="icon fab fa-github text-xl"></i>
          </div>
          <div>
            <h3 id="github-contact-title" class="font-semibold">GitHub Issues</h3>
            <p class="text-sm">在GitHub上提交问题</p>
          </div>
        </div>
        <p class="text-sm mb-4">
          如果您是开发者，可以在GitHub上提交Issue，我们会及时处理。
        </p>
        <a href="https://github.com/HeZaoCha/ParkingManagement/issues" 
           target="_blank"
           rel="noopener noreferrer"
           class="btn block w-full py-2 px-4 rounded-lg transition-all text-center font-medium"
           aria-label="在新窗口打开GitHub Issues">
          <i class="fab fa-github mr-2" aria-hidden="true"></i>
          打开GitHub Issues
        </a>
      </article>

      {# CSDN私信 - 绿色主题 #}
      <article class="contact-card contact-card-csdn rounded-2xl p-6 shadow-lg" role="article" aria-labelledby="csdn-contact-title">
        <div class="flex items-center gap-3 mb-4">
          <div class="icon-bg w-12 h-12 rounded-full flex items-center justify-center transition-all" aria-hidden="true">
            <i class="icon fas fa-comment text-xl"></i>
          </div>
          <div>
            <h3 id="csdn-contact-title" class="font-semibold">CSDN私信</h3>
            <p class="text-sm">通过CSDN联系作者</p>
          </div>
        </div>
        <p class="text-sm mb-4">
          您可以在CSDN上私信作者，我们会尽快回复您的问题。
        </p>
        <a href="https://blog.csdn.net/m0_68192925?type=blog" 
           target="_blank"
           rel="noopener noreferrer"
           class="btn block w-full py-2 px-4 rounded-lg transition-all text-center font-medium"
           aria-label="在新窗口打开CSDN博客">
          <i class="fas fa-external-link-alt mr-2" aria-hidden="true"></i>
          打开CSDN博客
        </a>
      </article>

      {# 在岗工作人员 - 橙色主题 #}
      <article class="contact-card contact-card-staff rounded-2xl p-6 shadow-lg" role="article" aria-labelledby="staff-contact-title">
        <div class="flex items-center gap-3 mb-4">
          <div class="icon-bg w-12 h-12 rounded-full flex items-center justify-center transition-all" aria-hidden="true">
            <i class="icon fas fa-user-tie text-xl"></i>
          </div>
          <div>
            <h3 id="staff-contact-title" class="font-semibold">在岗工作人员</h3>
            <p class="text-sm">联系当前在岗的工作人员</p>
          </div>
        </div>
        <p class="text-sm mb-4">
          查询当前在岗的工作人员联系方式，获取实时帮助。
        </p>
        <button type="button"
                onclick="showOnDutyStaff()" 
                class="btn w-full py-2 px-4 rounded-lg transition-all font-medium"
                aria-label="查看当前在岗工作人员">
          <i class="fas fa-users mr-2" aria-hidden="true"></i>
          查看在岗人员
        </button>
      </article>
    </section>

    {# 反馈表单模态框 #}
    <div id="email-form-modal" 
         class="fixed inset-0 bg-black bg-opacity-50 z-50 hidden items-center justify-center p-4"
         role="dialog"
         aria-modal="true"
         aria-labelledby="email-form-modal-title"
         aria-describedby="email-form-modal-description">
      <div class="bg-theme-card rounded-2xl p-6 max-w-2xl w-full max-h-[90vh] overflow-y-auto">
        <div class="flex items-center justify-between mb-6">
          <h2 id="email-form-modal-title" class="text-2xl font-bold text-theme-primary">
            <i class="fas fa-envelope text-primary-500 mr-2" aria-hidden="true"></i>
            反馈表单
          </h2>
          <button type="button"
                  onclick="hideEmailForm()" 
                  class="text-theme-muted hover:text-theme-primary"
                  aria-label="关闭反馈表单对话框">
            <i class="fas fa-times text-xl" aria-hidden="true"></i>
          </button>
        </div>
        <p id="email-form-modal-description" class="sr-only">填写反馈表单，向我们发送您的意见、建议或问题</p>

        <form id="contact-form" onsubmit="submitContactForm(event)" novalidate>
          <div class="space-y-4">
            {# 消息类型 #}
            <div>
              <label for="contact-message-type" class="block text-sm font-medium text-theme-secondary mb-2">消息类型</label>
              <select id="contact-message-type"
                      name="message_type" 
                      class="input-theme w-full rounded-lg px-4 py-2" 
                      required
                      aria-describedby="message-type-hint">
                <option value="feedback">意见反馈</option>
                <option value="bug">问题报告</option>
                <option value="suggestion">功能建议</option>
                <option value="other">其他</option>
              </select>
              <p id="message-type-hint" class="text-xs text-theme-muted mt-1 sr-only">选择消息类型</p>
            </div>

            {# 姓名 #}
            <div>
              <label for="contact-name" class="block text-sm font-medium text-theme-secondary mb-2">
                姓名 <span class="text-red-500" aria-label="必填">*</span>
              </label>
              <input type="text" 
                     id="contact-name"
                     name="name" 
                     class="input-theme w-full rounded-lg px-4 py-2" 
                     required 
                     placeholder="请输入您的姓名"
                     aria-describedby="contact-name-hint"
                     aria-required="true"
                     autocomplete="name">
              <p id="contact-name-hint" class="text-xs text-theme-muted mt-1 sr-only">请输入您的姓名</p>
              <div id="contact-name-error" class="text-xs text-red-500 mt-1 hidden" role="alert" aria-live="polite"></div>
            </div>

            {# 邮箱 #}
            <div>
              <label for="contact-email" class="block text-sm font-medium text-theme-secondary mb-2">
                邮箱 <span class="text-red-500" aria-label="必填">*</span>
              </label>
              <input type="email" 
                     id="contact-email"
                     name="email" 
                     class="input-theme w-full rounded-lg px-4 py-2" 
                     required 
                     placeholder="your@email.com"
                     aria-describedby="contact-email-hint"
                     aria-required="true"
                     autocomplete="email">
              <p id="contact-email-hint" class="text-xs text-theme-muted mt-1 sr-only">请输入您的邮箱地址</p>
              <div id="contact-email-error" class="text-xs text-red-500 mt-1 hidden" role="alert" aria-live="polite"></div>
            </div>

            {# 手机号 #}
            <div>
              <label class="block text-sm font-medium text-theme-secondary mb-2" for="contact-phone-input">
                手机号（选填）
              </label>
              <div id="contact-phone-hint" class="text-xs text-theme-muted mb-2">
                <i class="fas fa-info-circle mr-1"></i>
                请选择国家/地区，区号将显示在国旗区域
              </div>
              <div class="relative">
                <input type="tel" 
                       name="phone" 
                       id="contact-phone-input"
                       autocomplete="tel"
                       class="input-theme w-full rounded-lg px-4 py-2 pr-10"
                       style="padding-left: 80px !important;"
                       aria-describedby="contact-phone-hint contact-phone-error">
                <div id="contact-phone-validation-icon" class="absolute right-3 top-1/2 -translate-y-1/2 hidden pointer-events-none z-10">
                  <i class="fas fa-check-circle text-green-500" id="contact-phone-valid-icon"></i>
                  <i class="fas fa-times-circle text-red-500" id="contact-phone-invalid-icon"></i>
                </div>
              </div>
              <div id="contact-phone-error" class="text-xs text-red-500 mt-1 hidden" role="alert" aria-live="polite"></div>
            </div>

            {# 主题 #}
            <div>
              <label for="contact-subject" class="block text-sm font-medium text-theme-secondary mb-2">
                主题 <span class="text-red-500" aria-label="必填">*</span>
              </label>
              <input type="text" 
                     id="contact-subject"
                     name="subject" 
                     class="input-theme w-full rounded-lg px-4 py-2" 
                     required 
                     placeholder="请简要描述您的问题或建议"
                     aria-describedby="contact-subject-hint"
                     aria-required="true">
              <p id="contact-subject-hint" class="text-xs text-theme-muted mt-1 sr-only">请输入主题，简要描述您的问题或建议</p>
              <div id="contact-subject-error" class="text-xs text-red-500 mt-1 hidden" role="alert" aria-live="polite"></div>
            </div>

            {# 内容 #}
            <div>
              <label for="contact-content" class="block text-sm font-medium text-theme-secondary mb-2">
                详细内容 <span class="text-red-500" aria-label="必填">*</span>
              </label>
              <textarea id="contact-content"
                        name="content" 
                        rows="6" 
                        class="input-theme w-full rounded-lg px-4 py-2" 
                        required 
                        placeholder="请详细描述您的问题、建议或意见..."
                        aria-describedby="contact-content-hint"
                        aria-required="true"></textarea>
              <p id="contact-content-hint" class="text-xs text-theme-muted mt-1 sr-only">请详细描述您的问题、建议或意见</p>
              <div id="contact-content-error" class="text-xs text-red-500 mt-1 hidden" role="alert" aria-live="polite"></div>
            </div>

            {# 提交按钮 #}
            <div class="flex gap-3 pt-4" role="group" aria-label="表单操作">
              <button type="submit" 
                      class="flex-1 py-3 px-6 bg-primary-500 text-white rounded-lg hover:bg-primary-600 transition-colors font-medium"
                      aria-label="提交反馈表单">
                <i class="fas fa-paper-plane mr-2" aria-hidden="true"></i>
                提交反馈
              </button>
              <button type="button" 
                      onclick="hideEmailForm()" 
                      class="px-6 py-3 bg-theme-secondary text-theme-primary rounded-lg hover:bg-theme-hover transition-colors"
                      aria-label="取消并关闭反馈表单">
                取消
              </button>
            </div>
          </div>
        </form>
      </div>
    </div>
  </div>
</div>


<script src="{% static 'contact/form/js/script.js' %}"></script>
{% endblock %}

